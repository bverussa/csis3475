import java.io.File;

import javax.swing.JComponent;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JTextField;

public class Database
{	
	private static String dbName;
	
//	public Database()
//	{
		// First check if user is Admin - create function
		
//		String dbName;
//		
//		switch(option)
//		{
//			case 1: // Create DB
//				dbName = getDBName("Create Database");
//				if (dbName != null) createDB(dbName);
//				break;
//			case 2: // Delete DB
//				dbName = getDBName("Delete Database");
//				if (dbName != null) deleteDB(dbName);
//				deleteDB(dbName);
//				break;
//			case 3: // Create Table
//				
//			default:
//				JOptionPane.showMessageDialog(null, "Please, enter a correct Database name");
//		}
//	}
	
	private String getDBName(String msg)
	{
		JTextField dbName = new JTextField();
		final JComponent[] input = new JComponent[] 
		{
			new JLabel("Database Name:"), dbName
		};
		
		int result = JOptionPane.showConfirmDialog(null, input, msg, JOptionPane.PLAIN_MESSAGE);
		
		if (result == JOptionPane.OK_OPTION)
		{
			return dbName.getText();
		}
		else
		{
			return null;
		}
	}
	
	public void createDB()
	{
		ClientApplication app = new ClientApplication();
		this.dbName = getDBName("Create Database");
		
		if (this.dbName != null)
		{
			File database = new File("Databases/" + dbName);
			
			if (!database.exists())
			{
				boolean check = false;
				
				try
				{
					database.mkdirs();
					check = true;
				}
				catch(SecurityException e)
				{
					JOptionPane.showMessageDialog(null, e);
				}
				if (check)
				{
					JOptionPane.showMessageDialog(null, "Database " + dbName + " created!");
				}
				
				ClientApplication.currentDB = this.dbName;
			}
			else
			{
				JOptionPane.showMessageDialog(null, "Database " + dbName + " already exist!");
				ClientApplication.currentDB = this.dbName;
			}
		}
		this.dbName = null;
		ClientApplication.currentDB = Database.dbName;
	}
	
	public void deleteDB()
	{
		Database.dbName = getDBName("Create Database");
		
		if (Database.dbName != null)
		{
			File database = new File("Databases/" + dbName);
			
			if (!database.exists())
			{
				File[] tables = database.listFiles();
		        if (tables != null)
		        {
		            for (int i = 0; i < tables.length; i++)
		            {
		                tables[i].delete();
		            }
		        }
		        
		        database.delete();
		        JOptionPane.showMessageDialog(null, "Database " + dbName + " deleted!");
		        ClientApplication.currentDB = null;
			}
			else
			{
				JOptionPane.showMessageDialog(null, "Database " + dbName + " does not exist!");
			}
		}
	}
}
